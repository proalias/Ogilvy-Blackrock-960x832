<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">

    <link href="./s/styles.css" rel="stylesheet" type="text/css" />


    <title>Blackrock</title>
    <script type="text/javascript" src="./j/easeljs-0.7.0.min.js"> </script>
    <script type="text/javascript" src="./j/tweenjs-0.5.0.min.js"> </script>
    <script type="text/javascript" src="./j/Tween.js"></script>
    <script type="text/javascript" src="./j/Ease.js"></script>
    <script type="text/javascript" src="./j/movieclip-0.7.0.min.js"> </script>

</head>
<body onload="setup();">
    <div class="canvasHolder" style="background-color: #000" width="960" height="832">
            <canvas id="stage" width="960" height="832"></canvas>
    </div>
</body>

<script>


    var stage;

    //images
    var upImages = [];
    var downImages = [];
    var chevron;

    //vectors
    var bg;
    //switches
    var started = false;

    //state
    var currentSection;


    //timings
    var t_upBeginFrame      = 00001;
    var t_downBeginFrame    = 03000;
    var t_chevronBeginFrame = 06000;
    var t_ctaBeginFrame     = 10000;


    up_sizes=[];
    up_sizes[0] = 0.51;
    up_sizes[1] = 0.91;
    up_sizes[2] = 0.31;
    up_sizes[3] = 0.41;
    up_sizes[4] = 0.81;
    up_sizes[5] = 0.81;
    up_sizes[6] = 0.81;
    up_sizes[7] = 0.81;
    up_sizes[8] = 0.81;


    down_sizes=[];
    down_sizes[0] = 1.00;
    down_sizes[1] = 0.849;
    down_sizes[2] = 0.61;
    down_sizes[3] = 0.798;
    down_sizes[4] = 0.817;
    down_sizes[5] = 0.695;
    down_sizes[6] = 0.798;
    down_sizes[7] = 0.798;
    down_sizes[8] = 0.689;
    down_sizes[9] = 0.81;


    //up arrow start + end positions
    positions = [];


    positions["up_start"]=[];

    positions["up_start"][0] = [-604,504];
    positions["up_start"][1] = [-702,630];
    positions["up_start"][2] = [-660,880];
    positions["up_start"][3] = [40,842];
    positions["up_start"][4] = [-111,842];
    positions["up_start"][5] = [-542,818];
    positions["up_start"][6] = [-430,224];
    positions["up_start"][7] = [-706,311];
    positions["up_start"][8] = [-581,126];

    positions["up_mid"]=[];

    positions["up_mid"][0] = [170,240];
    positions["up_mid"][1] = [20,256];
    positions["up_mid"][2] = [-222,636];
    positions["up_mid"][3] = [540,566];
    positions["up_mid"][4] = [356,588];
    positions["up_mid"][5] = [356,382];
    positions["up_mid"][6] = [25,-8];
    positions["up_mid"][7] = [244,-188];
    positions["up_mid"][8] = [258,-52];


    positions["up_end"]=[];

    positions["up_end"][0] = [0,0];
    positions["up_end"][1] = [0,0];
    positions["up_end"][2] = [0,0];
    positions["up_end"][3] = [0,0];
    positions["up_end"][4] = [0,0];
    positions["up_end"][5] = [0,0];
    positions["up_end"][6] = [0,0];
    positions["up_end"][7] = [0,0];
    positions["up_end"][8] = [0,0];




    //down arrow start + end positions

    positions["down_start"]=[];

    positions["down_start"][0] = [-824,-628];
    positions["down_start"][1] = [-630,-95];
    positions["down_start"][2] = [-326,-594];
    positions["down_start"][3] = [-81,-532];
    positions["down_start"][4] = [-725,-54];
    positions["down_start"][5] = [-823,12];
    positions["down_start"][6] = [-557,-364];
    positions["down_start"][7] = [-283,-449];
    positions["down_start"][8] = [-658,-594];
    positions["down_start"][9] = [-496,-208];

    positions["down_end"]=[];

    positions["down_end"][0] = [0,0];
    positions["down_end"][1] = [0,0];
    positions["down_end"][2] = [0,0];
    positions["down_end"][3] = [0,0];
    positions["down_end"][4] = [0,0];
    positions["down_end"][5] = [0,0];
    positions["down_end"][6] = [0,0];
    positions["down_end"][7] = [0,0];
    positions["down_end"][8] = [0,0];
    positions["down_end"][9] = [0,0];   


    //setup

    function setup(){
        currentSection = -1;
        stage = new createjs.Stage("stage");
        createjs.Ticker.addEventListener("tick", handleTick);

        bg = new createjs.Shape();
        bg.graphics.beginFill("#ff0000").drawRect(0, 0, stage.width, stage.height);
        stage.addChild(bg);
    }

    function setupUpSequence(){

        stage.removeAllChildren();

        for (var i=0;i<9;i++){
            var image = new createjs.Bitmap("./i/up.png");
            stage.addChild(image);

            image.x = positions["up_start"][i][0];
            image.y = positions["up_start"][i][1];

            image.scaleX = up_sizes[i];
            image.scaleY = up_sizes[i];

            //var tween = createjs.Tween.get(image, {loop:false}).to({x:positions["up_mid"][i][0], y:positions["up_mid"][i][1]}, 2000*up_sizes[i], createjs.Ease.linear)
             //    .wait(10000)
              //   .to({x:positions["up_end"][i][0], y:positions["up_end"][i][1]}, 2500, createjs.Ease.bounceOut)
               //  .wait(10000);

            upImages.push(image);
        }

        stage.addChild(bg);
    }


    function setupDownSequence(){

        stage.removeAllChildren();

        for (var i=0;i<10;i++){
            var image = new createjs.Bitmap("./i/down.png");
            stage.addChild(image);

            image.x = positions["down_start"][i][0];
            image.y = positions["down_start"][i][1];

            image.scaleX = down_sizes[i];
            image.scaleY = down_sizes[i];

            //var tween = createjs.Tween.get(image, {loop:false}).to({x:positions["up_mid"][i][0], y:positions["up_mid"][i][1]}, 2000*up_sizes[i], createjs.Ease.linear)
            //    .wait(10000)
            //   .to({x:positions["up_end"][i][0], y:positions["up_end"][i][1]}, 2500, createjs.Ease.bounceOut)
            //  .wait(10000);

            downImages.push(image);
        }

        stage.addChild(bg);
    }


    function setupChevronSequence(){
        stage.removeAllChildren();
        chevron = new createjs.Bitmap("./i/chevron.png");
        stage.addChild(chevron);
    }

    function setupCTASequence(){

    }


    // Javascript doesn't have built-in support for ranges
    // Insted we use arrays of two elements to represent ranges
    var mapRange = function(from, to, s) {
        return to[0] + (s - from[0]) * (to[1] - to[0]) / (from[1] - from[0]);
    };


    function handleTick(event) {
        if (started == false){
            startTime = event.time;
            started = true;
        }

        var section = Math.floor(mapRange([startTime, t_ctaBeginFrame + startTime],[0,4],event.time));

        if (section != currentSection){
            //section changed - do setup
            switch (section){
                case 0:
                    setupUpSequence();
                    break;
                case 1:
                    setupDownSequence();
                    break;
                case 2:
                    setupChevronSequence();
                    break;
                case 3:
                    setupCTASequence();
                    break;
            }
            currentSection = section;
        }

        switch (section){
            case 0:
                updateUpSequence();
                break;
            case 1:
                updateDownSequence();
                break;
            case 2:
                updateChevronSequence();
                break;
            case 3:
                updateCTASequence();
                break;
        }

        stage.update();
    }

    function updateDownSequence(){
        for (var i=0;i<10;i++){
            var image = downImages[i];
            image.x += 11.5 * (5 * down_sizes[i]);
            image.y += 8.5 * (5 * down_sizes[i]);
        }
    }

    function updateUpSequence(){
        for (var i=0;i<9;i++){
            var image = upImages[i];
            image.x += 12.5 * (5 * up_sizes[i]);
            image.y -= 7.5 * (5 * up_sizes[i]);
        }
    }

    function updateChevronSequence(){
        chevron.x += 10;
    }

    function updateCTASequence(){
        var bar = 0;
        var foo = bar;
    }


</script>


</html>